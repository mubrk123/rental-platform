import{r as l,j as e}from"./index-BUXaKORS.js";import{a as x}from"./index-ngrFHoWO.js";import{z as d,F as Q}from"./index-ZL6epp1O.js";import{L as T}from"./loader-circle-B7CxhoPv.js";import{c as j}from"./createLucideIcon-Q5V_cY2S.js";import{M as I}from"./map-pin-vqMJFuWt.js";import{G as B}from"./gauge-BYISAX3v.js";import{T as R}from"./trash-2-CDPY1HTU.js";import{X as O}from"./x-TtlLZrZq.js";import{C as G}from"./cloud-upload-DdGyW6zw.js";/**
 * @license lucide-react v0.546.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const H=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 18h.01",key:"lrp35t"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M16 18h.01",key:"kzsmim"}]],q=j("calendar-days",H);/**
 * @license lucide-react v0.546.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const K=[["path",{d:"M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z",key:"sc7q7i"}]],X=j("funnel",K);/**
 * @license lucide-react v0.546.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const J=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]],W=j("pen",J),p=["All Locations","Lalbagh","NagaVara","Residency Road","Majestic (Gandhi Nagar)"],de=()=>{const[N,u]=l.useState([]),[w,c]=l.useState([]),[P,S]=l.useState(!0),[M,_]=l.useState("All Locations"),[i,g]=l.useState(null),[r,k]=l.useState({modelName:"",brand:"",rentPerDay:"",totalQuantity:"",city:p[1],type:"bike",kmLimitPerDay:""}),[V,v]=l.useState([]),[y,L]=l.useState([]),[Y,f]=l.useState({open:!1,loading:!1,data:[],vehicle:null}),o=l.useMemo(()=>({Authorization:`Bearer ${localStorage.getItem("adminToken")}`}),[]),C=l.useCallback(async()=>{try{const t=await x.get("https://rental-platform-0o9d.onrender.com/api/vehicles",{headers:o});u(t.data||[]),c(t.data||[])}catch{d.error("Failed to load vehicles.")}finally{S(!1)}},[o]);l.useEffect(()=>{C()},[C]);const $=t=>{if(_(t),t==="All Locations")return c(N);c(N.filter(a=>a.city===t||a.location?.city===t))},A=async t=>{if(window.confirm("Delete this vehicle?"))try{await x.delete(`https://rental-platform-0o9d.onrender.com/api/vehicles/${t}`,{headers:o}),u(a=>a.filter(s=>s._id!==t)),c(a=>a.filter(s=>s._id!==t)),d.success("Vehicle deleted!")}catch{d.error("Delete failed.")}},F=t=>{g(t),k({modelName:t.modelName,brand:t.brand,rentPerDay:String(t.rentPerDay),totalQuantity:String(t.totalQuantity),city:t.city||t.location?.city||p[1],type:t.type,kmLimitPerDay:String(t.kmLimitPerDay||150)}),v([]),L(t.images||[])},n=t=>{const{name:a,value:s}=t.target;k(m=>({...m,[a]:s}))},E=t=>{const a=Array.from(t.target.files);v(a),L([...y,...a.map(s=>URL.createObjectURL(s))])},U=async t=>{if(t.preventDefault(),!i)return;const a=new FormData;Object.entries(r).forEach(([s,m])=>{["rentPerDay","totalQuantity","kmLimitPerDay"].includes(s)?a.append(s,Number(m).toString()):a.append(s,m)}),V.forEach(s=>a.append("images",s));try{if((await x.put(`https://rental-platform-0o9d.onrender.com/api/vehicles/${i._id}`,a,{headers:{...o,"Content-Type":"multipart/form-data"}})).data?.success){d.success("Vehicle updated!");const D=(await x.get(`https://rental-platform-0o9d.onrender.com/api/vehicles/${i._id}`,{headers:o})).data;u(b=>b.map(h=>h._id===i._id?D:h)),c(b=>b.map(h=>h._id===i._id?D:h)),g(null)}else d.error("Update failed.")}catch{d.error("Server error.")}},z=async t=>{f({open:!0,loading:!0,data:[],vehicle:t});try{const a=await x.get(`https://rental-platform-0o9d.onrender.com/api/bookings/upcoming/${t._id}`,{headers:o}),s=Array.isArray(a.data?.bookings)?a.data.bookings:a.data||[];f({open:!0,loading:!1,data:s,vehicle:t})}catch{f({open:!0,loading:!1,data:[],vehicle:t,error:!0})}};return P?e.jsxs("div",{className:"flex justify-center items-center min-h-[60vh] text-indigo-600",children:[e.jsx(T,{className:"animate-spin w-6 h-6 mr-2"})," Loading uploaded vehicles..."]}):e.jsxs("div",{className:"bg-white shadow-md rounded-lg p-6 relative",children:[e.jsx(Q,{position:"top-center"}),e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between mb-6",children:[e.jsx("h2",{className:"text-2xl font-bold text-indigo-600 text-center sm:text-left mb-4 sm:mb-0",children:"Uploaded Vehicles"}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(X,{className:"w-5 h-5 text-indigo-600"}),e.jsx("select",{value:M,onChange:t=>$(t.target.value),className:"border border-indigo-300 text-gray-700 rounded-lg p-2 focus:ring-2 focus:ring-indigo-500 focus:outline-none",children:p.map(t=>e.jsx("option",{children:t},t))})]})]}),w.length===0?e.jsx("p",{className:"text-center text-gray-500",children:"No vehicles found for this location."}):e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6",children:w.map(t=>e.jsxs("div",{className:"border border-gray-200 rounded-xl overflow-hidden hover:shadow-lg transition-shadow bg-white",children:[e.jsx("img",{src:t.images?.[0]||"https://placehold.co/400x200?text=No+Image",alt:t.modelName,className:"w-full h-40 object-cover",loading:"lazy"}),e.jsxs("div",{className:"p-4",children:[e.jsx("h3",{className:"text-lg font-bold text-indigo-700 mb-1",children:t.modelName}),e.jsxs("p",{className:"text-sm text-gray-600 mb-1",children:[t.brand," • ",t.type]}),e.jsxs("p",{className:"flex items-center text-xs text-gray-500 mb-1",children:[e.jsx(I,{className:"w-4 h-4 mr-1 text-red-500"}),t.city||t.location?.city]}),e.jsxs("p",{className:"text-gray-700 text-sm font-semibold",children:["₹",t.rentPerDay," / day"]}),e.jsxs("p",{className:"text-xs text-gray-600 mt-1 flex items-center",children:[e.jsx(B,{className:"w-4 h-4 mr-1 text-sky-500"}),t.kmLimitPerDay?`${t.kmLimitPerDay} km/day`:"150 km/day"]}),e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Available:"," ",e.jsx("span",{className:`font-bold ${t.availableCount>0?"text-green-600":"text-red-600"}`,children:t.availableCount})," ","Total: ",t.totalQuantity]}),e.jsxs("button",{onClick:()=>z(t),className:"mt-3 w-full bg-gradient-to-r from-indigo-500 to-purple-600 text-white py-2 rounded-lg text-sm font-medium flex justify-center items-center gap-2 transition-all",children:[e.jsx(q,{className:"w-4 h-4"})," View Upcoming Bookings"]}),e.jsxs("div",{className:"flex gap-2 mt-3",children:[e.jsxs("button",{onClick:()=>F(t),className:"w-1/2 bg-indigo-500 text-white py-2 rounded-md hover:bg-indigo-600 transition text-sm flex items-center justify-center",children:[e.jsx(W,{className:"w-4 h-4 mr-1"})," Edit"]}),e.jsxs("button",{onClick:()=>A(t._id),className:"w-1/2 bg-red-500 text-white py-2 rounded-md hover:bg-red-600 transition text-sm flex items-center justify-center",children:[e.jsx(R,{className:"w-4 h-4 mr-1"})," Delete"]})]})]})]},t._id))}),i&&e.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-lg relative p-6 max-h-[90vh] overflow-y-auto",children:[e.jsx("button",{onClick:()=>g(null),className:"absolute top-3 right-3 text-gray-500 hover:text-gray-700",children:e.jsx(O,{className:"w-5 h-5"})}),e.jsx("h2",{className:"text-2xl font-bold text-indigo-700 mb-4",children:"Edit Vehicle"}),e.jsxs("form",{onSubmit:U,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Model Name"}),e.jsx("input",{type:"text",name:"modelName",value:r.modelName,onChange:n,className:"border rounded-lg p-2 w-full"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Brand"}),e.jsx("input",{type:"text",name:"brand",value:r.brand,onChange:n,className:"border rounded-lg p-2 w-full"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Rent Per Day (₹)"}),e.jsx("input",{type:"number",name:"rentPerDay",value:r.rentPerDay,onChange:n,className:"border rounded-lg p-2 w-full"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Total Quantity"}),e.jsx("input",{type:"number",name:"totalQuantity",value:r.totalQuantity,onChange:n,className:"border rounded-lg p-2 w-full"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"City"}),e.jsx("select",{name:"city",value:r.city,onChange:n,className:"border rounded-lg p-2 w-full",children:p.filter(t=>t!=="All Locations").map(t=>e.jsx("option",{children:t},t))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Type"}),e.jsxs("select",{name:"type",value:r.type,onChange:n,className:"border rounded-lg p-2 w-full",children:[e.jsx("option",{value:"bike",children:"Bike"}),e.jsx("option",{value:"scooter",children:"Scooter"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"KM Limit Per Day"}),e.jsx("input",{type:"number",name:"kmLimitPerDay",value:r.kmLimitPerDay,onChange:n,className:"border rounded-lg p-2 w-full"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Upload Images (optional)"}),e.jsx("input",{type:"file",multiple:!0,accept:"image/*",onChange:E,className:"border rounded-lg p-2 w-full"})]}),y.length>0&&e.jsx("div",{className:"grid grid-cols-2 gap-3 mt-2",children:y.map((t,a)=>e.jsx("img",{src:t,alt:`preview-${a}`,className:"w-full h-28 object-cover rounded-md border"},a))}),e.jsxs("button",{type:"submit",className:"w-full bg-indigo-600 text-white py-2 rounded-lg hover:bg-indigo-700 flex items-center justify-center gap-2",children:[e.jsx(G,{className:"w-4 h-4"}),"Save Changes"]})]})]})})]})};export{de as default};
