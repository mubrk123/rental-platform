import{r,j as e}from"./index-Btv9iGSA.js";import{a as f}from"./index-ngrFHoWO.js";import{L as I}from"./loader-circle-CL8W0R8M.js";import{E as B}from"./eye-BvP7EABo.js";import{c as j}from"./createLucideIcon-YgWYpsS-.js";import{X as D}from"./x-BXUXNG5K.js";import{T as M}from"./trash-2-BRsSuzw4.js";/**
 * @license lucide-react v0.546.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]],L=j("pencil",$);/**
 * @license lucide-react v0.546.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]],z=j("save",_),V=()=>{const[x,N]=r.useState([]),[b,y]=r.useState(!0),[a,d]=r.useState(null),[v,h]=r.useState(!1),[l,p]=r.useState({}),[o,u]=r.useState([]),[w,g]=r.useState([]);r.useEffect(()=>{(async()=>{try{const s=await f.get("https://rental-platform-0o9d.onrender.com/api/sale-bikes");N(s.data.bikes||[])}catch(s){console.error("Error fetching sale bikes:",s)}finally{y(!1)}})()},[]);const k=t=>{h(!0),p({modelName:t.modelName,brand:t.brand,year:t.year||"",price:t.price,description:t.description||""}),u(t.images||[]),g([])},i=t=>p({...l,[t.target.name]:t.target.value}),E=t=>{g(Array.from(t.target.files))},C=t=>{const s=o.filter((n,m)=>m!==t);u(s)},S=async t=>{if(t.preventDefault(),!a)return;const s=new FormData;Object.entries(l).forEach(([n,m])=>s.append(n,m)),s.append("existingImages",JSON.stringify(o)),w.forEach(n=>s.append("newImages",n));try{await f.put(`https://rental-platform-0o9d.onrender.com/api/sale-bikes/${a._id}`,s,{headers:{"Content-Type":"multipart/form-data"}}),alert("✅ Bike updated successfully!"),window.location.reload()}catch(n){console.error("Update failed:",n),alert("❌ Failed to update bike details.")}},c=t=>t?t.startsWith("http")?t:`${"https://rental-platform-0o9d.onrender.com/api".replace("/api","")}${t}`:"https://placehold.co/400x300?text=No+Image";return b?e.jsxs("div",{className:"flex justify-center items-center h-64 text-blue-700",children:[e.jsx(I,{className:"w-6 h-6 animate-spin mr-2"})," Loading sale bikes..."]}):e.jsxs("div",{className:"p-6 bg-white rounded-lg shadow-md",children:[e.jsx("h2",{className:"text-2xl font-bold text-blue-700 mb-4",children:"Bikes for Sale"}),x.length===0?e.jsx("p",{className:"text-gray-600 text-center py-8",children:"No bikes uploaded yet."}):e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6",children:x.map(t=>e.jsxs("div",{className:"bg-white border border-blue-100 rounded-lg shadow-sm hover:shadow-lg transition",children:[e.jsx("img",{src:c(t.images?.[0]),alt:t.modelName,className:"w-full h-48 object-cover rounded-t-lg",onError:s=>s.target.src="https://placehold.co/400x300?text=No+Image"}),e.jsxs("div",{className:"p-4 space-y-1",children:[e.jsx("h3",{className:"text-lg font-semibold text-blue-800",children:t.modelName}),e.jsx("p",{className:"text-sm text-gray-600",children:t.brand}),e.jsxs("p",{className:"text-sm font-medium text-blue-600",children:["₹",t.price]}),e.jsxs("div",{className:"flex gap-2 mt-3",children:[e.jsxs("button",{onClick:()=>d(t),className:"flex-1 flex items-center justify-center bg-gradient-to-r from-sky-500 to-blue-600 text-white px-3 py-2 rounded-lg hover:from-sky-400 hover:to-blue-500 transition",children:[e.jsx(B,{className:"w-4 h-4 mr-1"})," View"]}),e.jsxs("button",{onClick:()=>{d(t),k(t)},className:"flex-1 flex items-center justify-center bg-blue-600 text-white px-3 py-2 rounded-lg hover:bg-blue-700 transition",children:[e.jsx(L,{className:"w-4 h-4 mr-1"})," Edit"]})]})]})]},t._id))}),a&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl w-[90%] max-w-lg relative p-6 overflow-y-auto max-h-[90vh]",children:[e.jsx("button",{onClick:()=>{d(null),h(!1)},className:"absolute top-3 right-3 text-gray-500 hover:text-gray-700",children:e.jsx(D,{className:"w-5 h-5"})}),v?e.jsxs("form",{onSubmit:S,className:"space-y-4",children:[e.jsx("h2",{className:"text-2xl font-bold mb-2 text-blue-700",children:"Edit Bike Details"}),e.jsxs("div",{children:[e.jsx("input",{type:"text",name:"modelName",value:l.modelName,onChange:i,placeholder:"Model Name",className:"border rounded-lg p-2 w-full",required:!0}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Enter the official model name of the bike."})]}),e.jsxs("div",{children:[e.jsx("input",{type:"text",name:"brand",value:l.brand,onChange:i,placeholder:"Brand",className:"border rounded-lg p-2 w-full",required:!0}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Manufacturer name (e.g., Yamaha, Honda)."})]}),e.jsxs("div",{children:[e.jsx("input",{type:"number",name:"year",value:l.year,onChange:i,placeholder:"Year",className:"border rounded-lg p-2 w-full"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Year of manufacturing (optional)."})]}),e.jsxs("div",{children:[e.jsx("input",{type:"number",name:"price",value:l.price,onChange:i,placeholder:"Price (₹)",className:"border rounded-lg p-2 w-full",required:!0}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Enter the selling price in rupees."})]}),e.jsxs("div",{children:[e.jsx("textarea",{name:"description",value:l.description,onChange:i,placeholder:"Short Description",className:"border rounded-lg p-2 w-full"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Brief details about the bike’s condition or highlights."})]}),o.length>0&&e.jsxs("div",{className:"mt-4",children:[e.jsx("p",{className:"font-medium text-gray-700 mb-2",children:"Existing Images:"}),e.jsx("div",{className:"grid grid-cols-2 gap-3",children:o.map((t,s)=>e.jsxs("div",{className:"relative group",children:[e.jsx("img",{src:c(t),alt:`bike-${s}`,className:"w-full h-32 object-cover rounded-lg border"}),e.jsxs("button",{type:"button",onClick:()=>C(s),className:"absolute top-1 right-1 bg-red-500 text-white text-xs px-2 py-1 rounded opacity-80 hover:opacity-100 transition flex items-center gap-1",children:[e.jsx(M,{className:"w-3 h-3"})," Delete"]})]},s))})]}),e.jsxs("div",{className:"mt-4",children:[e.jsx("input",{type:"file",multiple:!0,accept:"image/*",onChange:E,className:"border rounded-lg p-2 w-full"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Upload new images (optional)."})]}),e.jsxs("button",{type:"submit",className:"w-full bg-blue-600 text-white py-2 rounded-lg hover:bg-blue-700 flex items-center justify-center gap-2 mt-2",children:[e.jsx(z,{className:"w-4 h-4"})," Save Changes"]})]}):e.jsxs(e.Fragment,{children:[e.jsx("h2",{className:"text-2xl font-bold mb-3 text-blue-700",children:a.modelName}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Brand:"})," ",a.brand]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Year:"})," ",a.year||"—"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Price:"})," ₹",a.price]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Description:"})," ",a.description||"No description available"]})]}),a.images?.length>0&&e.jsx("div",{className:"grid grid-cols-2 gap-2 mt-4",children:a.images.map((t,s)=>e.jsx("img",{src:c(t),alt:`bike-${s}`,className:"w-full h-32 object-cover rounded-lg border"},s))})]})]})})]})};export{V as default};
